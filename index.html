<!DOCTYPE html> 
<html> 
<head> 

<meta charset="utf-8">
 
<title>Lets Eat</title> 
<style type="text/css">
.input {
text-transform:lowercase;
}

#page {
	background-image:url(images/logo-lets-eat-hamburgeria3.png);
	background-repeat: no-repeat;
	background-size:100%;

}

#page3 {
	background-image:url(images/logo-lets-eat-hamburgeria3.png);
	background-repeat: no-repeat;
	background-size:100%;
}
#page4 {
	
	background-image:url(images/logo-lets-eat-hamburgeria3.png);
	background-repeat: no-repeat;
	background-size:100%;
	
}

form label, form input {
    display: block;
    margin: 0 0 10px 0;
}
form input {
  height: 20px;   
}

div.controls #name {
border-radius: 90px;
}
</style>
<link href="css/main.css"/>
<script src="scripts/jquery.js" type="text/javascript"></script>
<script src="scripts/jquery.ui.draggable.js" type="text/javascript"></script>
<script src="scripts/jquery.alerts.js" type="text/javascript"></script>
<script src="jquery-mobile/jquery.mobile-1.0.min.js" type="text/javascript"></script>
<link href="css/jquery.alerts.css" rel="stylesheet" type="text/css" media="screen" />
<link href="jquery-mobile/jquery.mobile.structure-1.0.min.css" rel="stylesheet" type="text/css" />
<meta name="viewport" content="initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link href="jquery-mobile/jquery.mobile.theme-1.0.min.css" rel="stylesheet" type="text/css">
<link href="jquery-mobile/jquery.mobile.structure-1.0.min.css" rel="stylesheet" type="text/css">
      
<script src="jquery-mobile/jquery-1.6.4.min.js" type="text/javascript"></script>
<script src="jquery-mobile/jquery.mobile-1.0.min.js" type="text/javascript">
</script>
<script type="text/javascript">
function Trim(str){
	return str.replace(/^\s+|\s+$/g,"");
}
</script>
<script type="text/javascript" src="jquery-mobile/jquery.min.js"></script>
    
<!-- SCRIPT Esqueci minha senha-->
    <script type="text/javascript">
	jQuery(document).ready(function(){
		jQuery('#ajax_form2').submit(function(){
			var dados = jQuery( this ).serialize();
			var email = ajax_form1.email.value;	
				

				jQuery.ajax({
				type: "POST",
				url: "http://app.rjag.com.br/app/Esqueci.php",
				data: dados,
				success: function( data ){
									
				if(data == 2) {
				jAlert('E-mail não cadastrado', '', 
						function() {
						$.alerts.dialogClass = null; 
						ajax_form1.email.focus();
						
					});
				} else{
				
				jAlert('Senha enviada', '', 
						function() {
						$.alerts.dialogClass = null; 
						ajax_form1.email.focus();
						
					});
				}
					
				}
			});

			return false;
		});
	});
	</script>
    
</head> 
<body>
  <div class="app">
<div id="deviceready" class="blink">
    <p class="event listening"></p>
                <p class="event received"></p>
            </div>
        </div>


<!--Pagina Inicial-->
<div data-role="page" id="page">
<div data-role="content"><br>
<div id="conteudo"><span class="expand"></span></div><br>
<div id="logo" align="center"> 
<img class="bg" src="images/logo3.png"/> </div>
<br>
<form method="post" action="" id="ajax_form1" name="ajax_form1" onSubmit="return"  class="expand" >
	<label><input class="input" type="text" placeholder="Email" id="email" name="email" onkeyup="this.value = Trim( this.value )" ></label>
    <label><input type="password" placeholder="Senha" id="senha" name="senha"  onkeyup="this.value = Trim( this.value )"> </label> 

	<label><input type="submit" name="entrar" id="entrar	" value="Enviar" /></label>  
    
</form>

  <a href="#page3" data-role="button">Cadastro</a> 
  <a href="#page4" data-role="button">Esqueci minha senha</a><br>
	<b><div align="center">FIDELIDADE</div></b>
  </div>
  </div>

<!-- Pagina Cadastro-->
<div data-role="page" id="page3">
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p><br>
<div data-role="content">

<form method="post" action="" id="ajax_form" name="ajax_form" onSubmit="return" >
		
		<input type="text" class="input" placeholder="Nome" name="nome" id="nome">
		<input type="text" placeholder="dd/mm/aaaa" name="data_aniversario" id="data_aniversario">
        <input type="text"  class="input" placeholder="Email" name="email" id="email" onkeyup="this.value = Trim( this.value )">
		 <input type="text" placeholder="Senha" name="senha" id="senha" onkeyup="this.value = Trim( this.value )">
	    <label><input type="submit" name="enviar" value="Enviar" /></label>
	</form>
 </div>
 </div>
    
<!-- Pagina Esqueci Minha senha-->
<div data-role="page" align="center" id="page4">
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div data-role="content">
<div id="conteudo"><span class="expand"></span></div>
<form method="post" action="" id="ajax_form2" name="ajax_form2" onSubmit="return"  class="expand" >
		<label><input class="input" type="text" placeholder="Email" id="email" name="email" onkeyup="this.value = Trim( this.value )"></label>
		<label><input type="submit" name="entrar" id="entrar	" value="Enviar Senha" /></label>  
</form>
  </div>
 </div>

</body>
</html> 


<script type="text/javascript" src="jquery-mobile/jquery-1.3.2.js"></script>
<script type="text/javascript" src="phonegap.js"></script>
<script type="text/javascript" src="PushNotification.js"></script>

<script type="text/javascript">
registro=1;
var app = {
	
    // Application Constructor
    initialize: function() {
        this.bindEvents();
    },
    // Bind Event Listeners
    //
    // Bind any events that are required on startup. Common events are:
    // 'load', 'deviceready', 'offline', and 'online'.
    bindEvents: function() {
        document.addEventListener('deviceready', this.onDeviceReady, false);
    },
    // deviceready Event Handler
    //
    // The scope of 'this' is the event. In order to call the 'receivedEvent'
    // function, we must explicity call 'app.receivedEvent(...);'
    onDeviceReady: function() {
        app.receivedEvent('deviceready');
        var pushNotification = window.plugins.pushNotification;
        pushNotification.register(app.successHandler, app.errorHandler,{"senderID":"557084083002","ecb":"app.onNotificationGCM"});

    },
    // Update DOM on a Received Event
    receivedEvent: function(id) {
        var parentElement = document.getElementById(id);
        var listeningElement = parentElement.querySelector('.listening');
        var receivedElement = parentElement.querySelector('.received');

        listeningElement.setAttribute('style', 'display:none;');
        receivedElement.setAttribute('style', 'display:block;');

        console.log('Received Event: ' + id);
    },
    // result contains any message sent from the plugin call
    successHandler: function(result) {
        //alert('Callback Success! Result = '+result)
    },
    errorHandler:function(error) {
        alert(error);
    },
    onNotificationGCM: function(e) {
        switch( e.event )
        {
            case 'registered':
                if ( e.regid.length > 0 )
                {
					
                    console.log("Regid " + e.regid);
                   // alert('registration id = '+e.regid);
					registro=e.regid;
									
                }
                break;

            case 'message':
                // this is the actual push notification. its format depends on the data model from the push server
               // alert('message = '+e.message+' msgcnt = '+e.msgcnt);
                break;

            case 'error':
               // alert('GCM error = '+e.msg);
                break;

            default:
              //  alert('An unknown GCM event has occurred');
                break;
        }


    },
 };


app.initialize();

	jQuery(document).ready(function(){
		
		
		//jQuery('#ajax_form').submit(function(){
		//	var dados = jQuery( this ).serialize();
		//	var temp = "&id_form="+registro ;
		//	dados+= temp;
		//	alert (""+temp);
			
	jQuery('#ajax_form').submit(function(){
			var dados = jQuery( this ).serialize();
			var temp = "&id_form="+registro ;
			dados+= temp;
	 	
				
			var formula = $('#ajax_form').serialize();	
			var nome = ajax_form.nome.value;
			var data_aniversario = ajax_form.data_aniversario.value;
			var email = ajax_form.email.value;
			var senha = ajax_form.senha.value;
			var patternData = /^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/;
			var filtro_mail = /^.+@.+\..{2,3}$/;
			
			
if (nome == "") {

				jAlert('Preencha o campo com seu nome', '',
				function() {
				$.alerts.dialogClass = null; 
				ajax_form.nome.focus();
												
					});
}
else if (nome.length <= 5) {
						jAlert('Digite seu nome completo', '', 
						function() {
						$.alerts.dialogClass = null;
						ajax_form.nome.focus();
											
					});
					
}					

else if (data_aniversario.length == "") {
						jAlert('Preencha a data de nascimento.', '', 
						function() {
						$.alerts.dialogClass = null;
						ajax_form.data_aniversario.focus();
												
					});
					
					}		
					
			
else if (!patternData.test(data_aniversario)) {
						 
						jAlert('Digite a data no formato DD/MM/AAAA', '', 
						function() {
						$.alerts.dialogClass = null;
						ajax_form.data_aniversario.focus();
												
					});
					
					}			
 
else if (!filtro_mail.test(email) || email=="") {
						jAlert('Informe um email valido', '', 
						function() {
						$.alerts.dialogClass = null; 
						ajax_form.email.focus();
						
					});
					
					}
else if (senha.length == "") {
						jAlert('Preencha o campo com sua senha', '', 
						function() {
						$.alerts.dialogClass = null; 
						ajax_form.senha.focus();
						
					});
					
					}
					
else if (senha.length < 4 ) {
						jAlert('Preencha o campo com uma senha maior', '', 								   						function() {
						$.alerts.dialogClass = null; 
						ajax_form.senha.focus();
						
					}); 
					
					}			
					
 if (nome.length > 5 && senha.length >= 4 && patternData.test(data_aniversario) == true && filtro_mail.test(email) == true){	
 
			jQuery.ajax({
				type: "POST",
				url: "http://app.rjag.com.br/app/cadastro.php",
				data: dados,
				success: function( data )
				{
					
					
				<!--	|| data == 0-->
					
				
				if(data == 1) {
				alert('Cadastro realizado');
				window.location = "";
				}
				
				if(data == 2) {
				jAlert('E-mail já existente', '', 
						function() {
						$.alerts.dialogClass = null; 
						ajax_form.senha.focus();
						
					});
				}
				
				if(data == '' ) {
				alert('Ocorreu um erro no banco de Dados');
				window.location = "";
				
				}
				
				}
			});
 }
			return false;
		});

	});
	
// JQUERY -----------------------------------LOGIN--------------------------------------------------------------------
	jQuery(document).ready(function(){
		jQuery('#ajax_form1').submit(function(){
			var dados = jQuery( this ).serialize();
			var temp = "&id_form="+registro ;
			dados+= temp;
			
			var email = ajax_form1.email.value;	
			var senha = ajax_form1.senha.value;		

			jQuery.ajax({
				type: "POST",
				url: "http://app.rjag.com.br/app/login-3.php",
				data: dados,
				success: function( data ){
								
			
				
				if(data == 2) {
				jAlert('Usuário ou senha inválidos', '', 
						function() {
						$.alerts.dialogClass = null; 
						ajax_form1.email.focus();
						
					});
				} else {window.location.replace("http://app.rjag.com.br/app/produtoXml.html");}
					
					
								
				}
			});

			return false;
		});
	});
	</script>
